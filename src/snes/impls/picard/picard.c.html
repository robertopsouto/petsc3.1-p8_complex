<center><a href="picard.c">Actual source code: picard.c</a></center><br>

<html>
<head>
<title></title>
<meta name="generator" content="c2html 0.9.5">
<meta name="date" content="2011-03-17T19:06:58+00:00">
</head>

<body bgcolor="#FFFFFF">
<pre width="80"><a name="line1">  1: </a><strong><font color="#228B22">#define PETSCSNES_DLL</font></strong>

<a name="line3"> 3: </a> #include <A href="../../../../include/../src/snes/impls/picard/picard.h.html">../src/snes/impls/picard/picard.h</A>

<a name="line5">  5: </a><font color="#B22222">/*</font>
<a name="line6">  6: </a><font color="#B22222">  SNESDestroy_Picard - Destroys the private SNES_Picard context that was created with SNESCreate_Picard().</font>

<a name="line8">  8: </a><font color="#B22222">  Input Parameter:</font>
<a name="line9">  9: </a><font color="#B22222">. snes - the <A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> context</font>

<a name="line11"> 11: </a><font color="#B22222">  Application Interface Routine: <A href="../../../../docs/manualpages/SNES/SNESDestroy.html#SNESDestroy">SNESDestroy</A>()</font>
<a name="line12"> 12: </a><font color="#B22222">*/</font>
<a name="line15"> 15: </a><strong><font color="#4169E1"><a name="SNESDestroy_Picard"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> SNESDestroy_Picard(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes)</font></strong>
<a name="line16"> 16: </a>{

<a name="line20"> 20: </a>  <font color="#4169E1">if</font> (snes-&gt;vec_sol_update) {
<a name="line21"> 21: </a>    <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(snes-&gt;vec_sol_update);
<a name="line22"> 22: </a>    snes-&gt;vec_sol_update = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
<a name="line23"> 23: </a>  }
<a name="line24"> 24: </a>  <font color="#4169E1">if</font> (snes-&gt;nwork) {
<a name="line25"> 25: </a>    <A href="../../../../docs/manualpages/Vec/VecDestroyVecs.html#VecDestroyVecs">VecDestroyVecs</A>(snes-&gt;work, snes-&gt;nwork);
<a name="line26"> 26: </a>    snes-&gt;nwork = 0;
<a name="line27"> 27: </a>    snes-&gt;work  = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
<a name="line28"> 28: </a>  }
<a name="line29"> 29: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(snes-&gt;data);
<a name="line30"> 30: </a>  <font color="#4169E1">return</font>(0);
<a name="line31"> 31: </a>}

<a name="line33"> 33: </a><font color="#B22222">/*</font>
<a name="line34"> 34: </a><font color="#B22222">   SNESSetUp_Picard - Sets up the internal data structures for the later use</font>
<a name="line35"> 35: </a><font color="#B22222">   of the <A href="../../../../docs/manualpages/SNES/SNESPICARD.html#SNESPICARD">SNESPICARD</A> nonlinear solver.</font>

<a name="line37"> 37: </a><font color="#B22222">   Input Parameters:</font>
<a name="line38"> 38: </a><font color="#B22222">+  snes - the <A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> context</font>
<a name="line39"> 39: </a><font color="#B22222">-  x - the solution vector</font>

<a name="line41"> 41: </a><font color="#B22222">   Application Interface Routine: <A href="../../../../docs/manualpages/SNES/SNESSetUp.html#SNESSetUp">SNESSetUp</A>()</font>
<a name="line42"> 42: </a><font color="#B22222"> */</font>
<a name="line45"> 45: </a><strong><font color="#4169E1"><a name="SNESSetUp_Picard"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> SNESSetUp_Picard(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes)</font></strong>
<a name="line46"> 46: </a>{

<a name="line50"> 50: </a>  <font color="#4169E1">if</font> (!snes-&gt;vec_sol_update) {
<a name="line51"> 51: </a>    <A href="../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>(snes-&gt;vec_sol, &amp;snes-&gt;vec_sol_update);
<a name="line52"> 52: </a>    PetscLogObjectParent(snes, snes-&gt;vec_sol_update);
<a name="line53"> 53: </a>  }
<a name="line54"> 54: </a>  <font color="#4169E1">if</font> (!snes-&gt;work) {
<a name="line55"> 55: </a>    snes-&gt;nwork = 1;
<a name="line56"> 56: </a>    <A href="../../../../docs/manualpages/Vec/VecDuplicateVecs.html#VecDuplicateVecs">VecDuplicateVecs</A>(snes-&gt;vec_sol, snes-&gt;nwork, &amp;snes-&gt;work);
<a name="line57"> 57: </a>    PetscLogObjectParents(snes,snes-&gt;nwork, snes-&gt;work);
<a name="line58"> 58: </a>  }
<a name="line59"> 59: </a>  <font color="#4169E1">return</font>(0);
<a name="line60"> 60: </a>}

<a name="line62"> 62: </a><strong><font color="#4169E1"><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PicardLineSearchQuadratic(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes, void *lsctx, <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> X, <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> F, <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> dummyG, <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> Y, <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> dummyW, <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> fnorm, <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> dummyXnorm, <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> *dummyYnorm, <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> *gnorm, <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flag)</font></strong>;
<a name="line63"> 63: </a><font color="#B22222">/*</font>
<a name="line64"> 64: </a><font color="#B22222">  SNESSetFromOptions_Picard - Sets various parameters for the <A href="../../../../docs/manualpages/SNES/SNESLS.html#SNESLS">SNESLS</A> method.</font>

<a name="line66"> 66: </a><font color="#B22222">  Input Parameter:</font>
<a name="line67"> 67: </a><font color="#B22222">. snes - the <A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> context</font>

<a name="line69"> 69: </a><font color="#B22222">  Application Interface Routine: <A href="../../../../docs/manualpages/SNES/SNESSetFromOptions.html#SNESSetFromOptions">SNESSetFromOptions</A>()</font>
<a name="line70"> 70: </a><font color="#B22222">*/</font>
<a name="line73"> 73: </a><strong><font color="#4169E1"><a name="SNESSetFromOptions_Picard"></a>static <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> SNESSetFromOptions_Picard(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes)</font></strong>
<a name="line74"> 74: </a>{
<a name="line75"> 75: </a>  SNES_Picard   *ls = (SNES_Picard *)snes-&gt;data;
<a name="line76"> 76: </a>  const char    *types[] = {<font color="#666666">"basic"</font>, <font color="#666666">"quadratic"</font>, <font color="#666666">"cubic"</font>};
<a name="line77"> 77: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       indx = 0;
<a name="line78"> 78: </a>  <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flg;

<a name="line82"> 82: </a>  <A href="../../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(<font color="#666666">"<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> Picard options"</font>);
<a name="line83"> 83: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>(<font color="#666666">"-snes_picard"</font>,<font color="#666666">"Picard Type"</font>,<font color="#666666">"<A href="../../../../docs/manualpages/SNES/SNESLineSearchSet.html#SNESLineSearchSet">SNESLineSearchSet</A>"</font>,types,3,<font color="#666666">"basic"</font>,&amp;indx,&amp;flg);
<a name="line84"> 84: </a>    ls-&gt;type = indx;
<a name="line85"> 85: </a>    <font color="#4169E1">if</font> (flg) {
<a name="line86"> 86: </a>      <font color="#4169E1">switch</font> (indx) {
<a name="line87"> 87: </a>      <font color="#4169E1">case</font> 0:
<a name="line88"> 88: </a>        <A href="../../../../docs/manualpages/SNES/SNESLineSearchSet.html#SNESLineSearchSet">SNESLineSearchSet</A>(snes,<A href="../../../../docs/manualpages/SNES/SNESLineSearchNo.html#SNESLineSearchNo">SNESLineSearchNo</A>,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
<a name="line89"> 89: </a>        <font color="#4169E1">break</font>;
<a name="line90"> 90: </a>      <font color="#4169E1">case</font> 1:
<a name="line91"> 91: </a>        <A href="../../../../docs/manualpages/SNES/SNESLineSearchSet.html#SNESLineSearchSet">SNESLineSearchSet</A>(snes,PicardLineSearchQuadratic,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
<a name="line92"> 92: </a>        <font color="#4169E1">break</font>;
<a name="line93"> 93: </a>      <font color="#4169E1">case</font> 2:
<a name="line94"> 94: </a>        <A href="../../../../docs/manualpages/SNES/SNESLineSearchSet.html#SNESLineSearchSet">SNESLineSearchSet</A>(snes,<A href="../../../../docs/manualpages/SNES/SNESLineSearchNo.html#SNESLineSearchNo">SNESLineSearchNo</A>,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
<a name="line95"> 95: </a>        <font color="#4169E1">break</font>;
<a name="line96"> 96: </a>      }
<a name="line97"> 97: </a>    }
<a name="line98"> 98: </a>    ls-&gt;alpha = 1.0;
<a name="line99"> 99: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsReal.html#PetscOptionsReal">PetscOptionsReal</A>(<font color="#666666">"-snes_picard_alpha"</font>,<font color="#666666">"Momentum parameter"</font>,<font color="#666666">"<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A>"</font>,ls-&gt;alpha,&amp;ls-&gt;alpha,&amp;flg);
<a name="line100">100: </a>  <A href="../../../../docs/manualpages/Sys/PetscOptionsTail.html#PetscOptionsTail">PetscOptionsTail</A>();
<a name="line101">101: </a>  <font color="#4169E1">return</font>(0);
<a name="line102">102: </a>}

<a name="line104">104: </a><font color="#B22222">/*</font>
<a name="line105">105: </a><font color="#B22222">  SNESView_Picard - Prints info from the <A href="../../../../docs/manualpages/SNES/SNESPICARD.html#SNESPICARD">SNESPICARD</A> data structure.</font>

<a name="line107">107: </a><font color="#B22222">  Input Parameters:</font>
<a name="line108">108: </a><font color="#B22222">+ <A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> - the <A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> context</font>
<a name="line109">109: </a><font color="#B22222">- viewer - visualization context</font>

<a name="line111">111: </a><font color="#B22222">  Application Interface Routine: <A href="../../../../docs/manualpages/SNES/SNESView.html#SNESView">SNESView</A>()</font>
<a name="line112">112: </a><font color="#B22222">*/</font>
<a name="line115">115: </a><strong><font color="#4169E1"><a name="SNESView_Picard"></a>static <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> SNESView_Picard(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes, <A href="../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
<a name="line116">116: </a>{
<a name="line117">117: </a>  SNES_Picard   *ls = (SNES_Picard *)snes-&gt;data;
<a name="line118">118: </a>  const char    *cstr;
<a name="line119">119: </a>  <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     iascii;

<a name="line123">123: </a>  <A href="../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) viewer, PETSC_VIEWER_ASCII, &amp;iascii);
<a name="line124">124: </a>  <font color="#4169E1">if</font> (iascii) {
<a name="line125">125: </a>    <font color="#4169E1">switch</font>(ls-&gt;type) {
<a name="line126">126: </a>    <font color="#4169E1">case</font> 0:
<a name="line127">127: </a>      cstr = <font color="#666666">"basic"</font>;
<a name="line128">128: </a>      <font color="#4169E1">break</font>;
<a name="line129">129: </a><strong><font color="#FF0000">    default:</font></strong>
<a name="line130">130: </a>      cstr = <font color="#666666">"unknown"</font>;
<a name="line131">131: </a>    }
<a name="line132">132: </a>    <A href="../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  picard variant: %s\n"</font>, cstr);
<a name="line133">133: </a>  } <font color="#4169E1">else</font> {
<a name="line134">134: </a>    <A href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP, <font color="#666666">"Viewer type %s not supported for <A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> Picard"</font>, ((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;type_name);
<a name="line135">135: </a>  }
<a name="line136">136: </a>  <font color="#4169E1">return</font>(0);
<a name="line137">137: </a>}

<a name="line141">141: </a><strong><font color="#4169E1"><a name="PicardLineSearchQuadratic"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PicardLineSearchQuadratic(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes, void *lsctx, <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> X, <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> F, <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> dummyG, <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> Y, <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> W, <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> fnorm, <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> dummyXnorm, <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> *dummyYnorm, <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> *gnorm, <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flag)</font></strong>
<a name="line142">142: </a>{
<a name="line143">143: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
<a name="line144">144: </a>  <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>      alphas[3] = {0.0, 0.5, 1.0};
<a name="line145">145: </a>  <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>      norms[3];
<a name="line146">146: </a>  <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>      alpha,a,b;

<a name="line150">150: </a>  norms[0]  = fnorm;
<a name="line151">151: </a>  <font color="#B22222">/* Calculate trial solutions */</font>
<a name="line152">152: </a>  <font color="#4169E1">for</font>(i = 1; i &lt; 3; ++i) {
<a name="line153">153: </a>    <font color="#B22222">/* Calculate X^{n+1} = (1 - \alpha) X^n + \alpha Y */</font>
<a name="line154">154: </a>    <A href="../../../../docs/manualpages/Vec/VecCopy.html#VecCopy">VecCopy</A>(X, W);
<a name="line155">155: </a>    <A href="../../../../docs/manualpages/Vec/VecAXPBY.html#VecAXPBY">VecAXPBY</A>(W, alphas[i], 1 - alphas[i], Y);
<a name="line156">156: </a>    <A href="../../../../docs/manualpages/SNES/SNESComputeFunction.html#SNESComputeFunction">SNESComputeFunction</A>(snes, W, F);
<a name="line157">157: </a>    <A href="../../../../docs/manualpages/Vec/VecNorm.html#VecNorm">VecNorm</A>(F, <A href="../../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A>, &amp;norms[i]);
<a name="line158">158: </a>  }
<a name="line159">159: </a>  <font color="#4169E1">for</font>(i = 0; i &lt; 3; ++i) {
<a name="line160">160: </a>    norms[i] = PetscSqr(norms[i]);
<a name="line161">161: </a>  }
<a name="line162">162: </a>  <font color="#B22222">/* Fit a quadratic:</font>
<a name="line163">163: </a><font color="#B22222">       If we have x_{0,1,2} = 0, x_1, x_2 which generate norms y_{0,1,2}</font>
<a name="line164">164: </a><font color="#B22222">       a = (x_1 y_2 - x_2 y_1 + (x_2 - x_1) y_0)/(x^2_2 x_1 - x_2 x^2_1)</font>
<a name="line165">165: </a><font color="#B22222">       b = (x^2_1 y_2 - x^2_2 y_1 + (x^2_2 - x^2_1) y_0)/(x_2 x^2_1 - x^2_2 x_1)</font>
<a name="line166">166: </a><font color="#B22222">       c = y_0</font>
<a name="line167">167: </a><font color="#B22222">       x_min = -b/2a</font>

<a name="line169">169: </a><font color="#B22222">       If we let x_{0,1,2} = 0, 0.5, 1.0</font>
<a name="line170">170: </a><font color="#B22222">       a = 2 y_2 - 4 y_1 + 2 y_0</font>
<a name="line171">171: </a><font color="#B22222">       b =  -y_2 + 4 y_1 - 3 y_0</font>
<a name="line172">172: </a><font color="#B22222">       c =   y_0</font>
<a name="line173">173: </a><font color="#B22222">  */</font>
<a name="line174">174: </a>  a = (alphas[1]*norms[2] - alphas[2]*norms[1] + (alphas[2] - alphas[1])*norms[0])/
<a name="line175">175: </a>    (PetscSqr(alphas[2])*alphas[1] - alphas[2]*PetscSqr(alphas[1]));
<a name="line176">176: </a>  b = (PetscSqr(alphas[1])*norms[2] - PetscSqr(alphas[2])*norms[1] + (PetscSqr(alphas[2]) - PetscSqr(alphas[1]))*norms[0])/
<a name="line177">177: </a>    (alphas[2]*PetscSqr(alphas[1]) - PetscSqr(alphas[2])*alphas[1]);
<a name="line178">178: </a>  <font color="#B22222">/* Check for positive a (concave up) */</font>
<a name="line179">179: </a>  <font color="#4169E1">if</font> (a &gt;= 0.0) {
<a name="line180">180: </a>    alpha = -b/(2.0*a);
<a name="line181">181: </a>    alpha = PetscMin(alpha, alphas[2]);
<a name="line182">182: </a>    alpha = PetscMax(alpha, alphas[0]);
<a name="line183">183: </a>  } <font color="#4169E1">else</font> {
<a name="line184">184: </a>    alpha = 1.0;
<a name="line185">185: </a>  }
<a name="line186">186: </a>  <A href="../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(snes-&gt;hdr.comm, <font color="#666666">"norms[0] = %g, norms[1] = %g, norms[2] = %g\n"</font>, sqrt(norms[0]), sqrt(norms[1]), sqrt(norms[2]));
<a name="line187">187: </a>  <A href="../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(snes-&gt;hdr.comm, <font color="#666666">"Choose alpha = %g\n"</font>, alpha);
<a name="line188">188: </a>  <A href="../../../../docs/manualpages/Vec/VecAXPBY.html#VecAXPBY">VecAXPBY</A>(X, alpha, 1 - alpha, Y);
<a name="line189">189: </a>  <A href="../../../../docs/manualpages/SNES/SNESComputeFunction.html#SNESComputeFunction">SNESComputeFunction</A>(snes, X, F);
<a name="line190">190: </a>  <A href="../../../../docs/manualpages/Vec/VecNorm.html#VecNorm">VecNorm</A>(F, <A href="../../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A>, gnorm);
<a name="line191">191: </a>  *flag = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
<a name="line192">192: </a>  <font color="#4169E1">return</font>(0);
<a name="line193">193: </a>}

<a name="line195">195: </a><font color="#B22222">/*</font>
<a name="line196">196: </a><font color="#B22222">  SNESSolve_Picard - Solves a nonlinear system with the Picard method.</font>

<a name="line198">198: </a><font color="#B22222">  Input Parameters:</font>
<a name="line199">199: </a><font color="#B22222">. snes - the <A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> context</font>

<a name="line201">201: </a><font color="#B22222">  Output Parameter:</font>
<a name="line202">202: </a><font color="#B22222">. outits - number of iterations until termination</font>

<a name="line204">204: </a><font color="#B22222">  Application Interface Routine: <A href="../../../../docs/manualpages/SNES/SNESSolve.html#SNESSolve">SNESSolve</A>()</font>
<a name="line205">205: </a><font color="#B22222">*/</font>
<a name="line208">208: </a><strong><font color="#4169E1"><a name="SNESSolve_Picard"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> SNESSolve_Picard(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes)</font></strong>
<a name="line209">209: </a>{
<a name="line210">210: </a>  SNES_Picard   *neP = (SNES_Picard *) snes-&gt;data;
<a name="line211">211: </a>  <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>            X, Y, F, W;
<a name="line212">212: </a>  <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>      alpha = neP-&gt;alpha;
<a name="line213">213: </a>  <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>      fnorm;
<a name="line214">214: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       maxits, i;

<a name="line218">218: </a>  snes-&gt;reason = SNES_CONVERGED_ITERATING;

<a name="line220">220: </a>  maxits = snes-&gt;max_its;             <font color="#B22222">/* maximum number of iterations */</font>
<a name="line221">221: </a>  X      = snes-&gt;vec_sol;             <font color="#B22222">/* X^n */</font>
<a name="line222">222: </a>  Y      = snes-&gt;vec_sol_update; <font color="#B22222">/* \tilde X */</font>
<a name="line223">223: </a>  F      = snes-&gt;vec_func;       <font color="#B22222">/* residual vector */</font>
<a name="line224">224: </a>  W      = snes-&gt;work[0];        <font color="#B22222">/* work vector */</font>

<a name="line226">226: </a>  PetscObjectTakeAccess(snes);
<a name="line227">227: </a>  snes-&gt;iter = 0;
<a name="line228">228: </a>  snes-&gt;norm = 0.;
<a name="line229">229: </a>  PetscObjectGrantAccess(snes);
<a name="line230">230: </a>  <A href="../../../../docs/manualpages/SNES/SNESComputeFunction.html#SNESComputeFunction">SNESComputeFunction</A>(snes,X,F);
<a name="line231">231: </a>  <font color="#4169E1">if</font> (snes-&gt;domainerror) {
<a name="line232">232: </a>    snes-&gt;reason = SNES_DIVERGED_FUNCTION_DOMAIN;
<a name="line233">233: </a>    <font color="#4169E1">return</font>(0);
<a name="line234">234: </a>  }
<a name="line235">235: </a>  <A href="../../../../docs/manualpages/Vec/VecNorm.html#VecNorm">VecNorm</A>(F, <A href="../../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A>, &amp;fnorm); <font color="#B22222">/* fnorm &lt;- ||F||  */</font>
<a name="line236">236: </a>  <font color="#4169E1">if</font> PetscIsInfOrNanReal(fnorm) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_FP,<font color="#666666">"Infinite or not-a-number generated in norm"</font>);
<a name="line237">237: </a>  PetscObjectTakeAccess(snes);
<a name="line238">238: </a>  snes-&gt;norm = fnorm;
<a name="line239">239: </a>  PetscObjectGrantAccess(snes);
<a name="line240">240: </a>  SNESLogConvHistory(snes,fnorm,0);
<a name="line241">241: </a>  SNESMonitor(snes,0,fnorm);

<a name="line243">243: </a>  <font color="#B22222">/* set parameter for default relative tolerance convergence test */</font>
<a name="line244">244: </a>  snes-&gt;ttol = fnorm*snes-&gt;rtol;
<a name="line245">245: </a>  <font color="#B22222">/* test convergence */</font>
<a name="line246">246: </a>  (*snes-&gt;ops-&gt;converged)(snes,0,0.0,0.0,fnorm,&amp;snes-&gt;reason,snes-&gt;cnvP);
<a name="line247">247: </a>  <font color="#4169E1">if</font> (snes-&gt;reason) <font color="#4169E1">return</font>(0);

<a name="line249">249: </a>  <font color="#4169E1">for</font>(i = 0; i &lt; maxits; i++) {
<a name="line250">250: </a>    <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> lsSuccess = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;

<a name="line252">252: </a>    <font color="#B22222">/* Call general purpose update function */</font>
<a name="line253">253: </a>    <font color="#4169E1">if</font> (snes-&gt;ops-&gt;update) {
<a name="line254">254: </a>      (*snes-&gt;ops-&gt;update)(snes, snes-&gt;iter);
<a name="line255">255: </a>    }
<a name="line256">256: </a>    <font color="#4169E1">if</font> (neP-&gt;type == 0) {
<a name="line257">257: </a>      <A href="../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(snes-&gt;hdr.comm, <font color="#666666">"Fixed alpha = %g\n"</font>, alpha);
<a name="line258">258: </a>      <font color="#B22222">/* Update guess Y = X^n - F(X^n) */</font>
<a name="line259">259: </a>      <A href="../../../../docs/manualpages/Vec/VecWAXPY.html#VecWAXPY">VecWAXPY</A>(Y, -1.0, F, X);
<a name="line260">260: </a>      <font color="#B22222">/* X^{n+1} = (1 - \alpha) X^n + \alpha Y */</font>
<a name="line261">261: </a>      <A href="../../../../docs/manualpages/Vec/VecAXPBY.html#VecAXPBY">VecAXPBY</A>(X, alpha, 1 - alpha, Y);
<a name="line262">262: </a>      <font color="#B22222">/* Compute F(X^{new}) */</font>
<a name="line263">263: </a>      <A href="../../../../docs/manualpages/SNES/SNESComputeFunction.html#SNESComputeFunction">SNESComputeFunction</A>(snes, X, F);
<a name="line264">264: </a>      <A href="../../../../docs/manualpages/Vec/VecNorm.html#VecNorm">VecNorm</A>(F, <A href="../../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A>, &amp;fnorm);
<a name="line265">265: </a>      <font color="#4169E1">if</font> PetscIsInfOrNanReal(fnorm) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_FP,<font color="#666666">"Infinite or not-a-number generated norm"</font>);
<a name="line266">266: </a>    } <font color="#4169E1">else</font> {
<a name="line267">267: </a>      <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> dummyNorm;
<a name="line268">268: </a>      <font color="#B22222">/* Compute a (scaled) negative update in the line search routine: </font>
<a name="line269">269: </a><font color="#B22222">         Y &lt;- X - lambda*Y </font>
<a name="line270">270: </a><font color="#B22222">         and evaluate G = function(Y) (depends on the line search). */</font>
<a name="line271">271: </a><font color="#A020F0">#if 1</font>
<a name="line272">272: </a>      <font color="#B22222">/* Calculate the solution increment, Y = X^n - F(X^n) */</font>
<a name="line273">273: </a>      <A href="../../../../docs/manualpages/Vec/VecWAXPY.html#VecWAXPY">VecWAXPY</A>(Y, -1.0, F, X);
<a name="line274">274: </a>      (*neP-&gt;LineSearch)(snes, neP-&gt;lsP, X, F, F<font color="#B22222">/*G*/</font>, Y, W, fnorm, 0.0, &amp;dummyNorm, &amp;fnorm, &amp;lsSuccess);
<a name="line275">275: </a><font color="#A020F0">#else</font>
<a name="line276">276: </a>      <font color="#B22222">/* Put this in function after it works */</font>
<a name="line277">277: </a>      <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> alphas[3] = {0.0, 0.5, 1.0};
<a name="line278">278: </a>      <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> norms[3];

<a name="line280">280: </a>      norms[0] = fnorm;
<a name="line281">281: </a>      <font color="#B22222">/* Calculate the solution increment, Y = X^n - F(X^n) */</font>
<a name="line282">282: </a>      <A href="../../../../docs/manualpages/Vec/VecWAXPY.html#VecWAXPY">VecWAXPY</A>(Y, -1.0, F, X);
<a name="line283">283: </a>      {
<a name="line284">284: </a>        <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> norm0, norm1;

<a name="line286">286: </a>        <A href="../../../../docs/manualpages/Vec/VecNorm.html#VecNorm">VecNorm</A>(n_3(X), <A href="../../../../docs/manualpages/Vec/NORM_INFINITY.html#NORM_INFINITY">NORM_INFINITY</A>, &amp;norm0);
<a name="line287">287: </a>        <A href="../../../../docs/manualpages/Vec/VecNorm.html#VecNorm">VecNorm</A>(n_3(Y), <A href="../../../../docs/manualpages/Vec/NORM_INFINITY.html#NORM_INFINITY">NORM_INFINITY</A>, &amp;norm1);
<a name="line288">288: </a>        <font color="#4169E1">if</font> (norm1 &gt; 0.9) {
<a name="line289">289: </a>          alpha[2] = (norm1 - 0.9)/(norm1 - norm0);
<a name="line290">290: </a>        }
<a name="line291">291: </a>      }
<a name="line292">292: </a>      alpha[1] = 0.5*alpha[2];
<a name="line293">293: </a>      <font color="#B22222">/* Calculate trial solutions */</font>
<a name="line294">294: </a>      <font color="#4169E1">for</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i = 1; i &lt; 3; ++i) {
<a name="line295">295: </a>        <font color="#B22222">/* Calculate X^{n+1} = (1 - \alpha) X^n + \alpha Y */</font>
<a name="line296">296: </a>        <A href="../../../../docs/manualpages/Vec/VecCopy.html#VecCopy">VecCopy</A>(X, W);
<a name="line297">297: </a>        <A href="../../../../docs/manualpages/Vec/VecAXPBY.html#VecAXPBY">VecAXPBY</A>(W, alphas[i], 1 - alphas[i], Y);
<a name="line298">298: </a>        <A href="../../../../docs/manualpages/SNES/SNESComputeFunction.html#SNESComputeFunction">SNESComputeFunction</A>(snes, W, F);
<a name="line299">299: </a>        <A href="../../../../docs/manualpages/Vec/VecNorm.html#VecNorm">VecNorm</A>(F, <A href="../../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A>, &amp;norms[i]);
<a name="line300">300: </a>      }
<a name="line301">301: </a>      <font color="#4169E1">for</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i = 0; i &lt; 3; ++i) {
<a name="line302">302: </a>        norms[i] = PetscSqr(norms[i]);
<a name="line303">303: </a>      }
<a name="line304">304: </a>      <font color="#B22222">/* Fit a quadratic:</font>
<a name="line305">305: </a><font color="#B22222">           If we have x_{0,1,2} = 0, x_1, x_2 which generate norms y_{0,1,2}</font>
<a name="line306">306: </a><font color="#B22222">           a = (x_1 y_2 - x_2 y_1 + (x_2 - x_1) y_0)/(x^2_2 x_1 - x_2 x^2_1)</font>
<a name="line307">307: </a><font color="#B22222">           b = (x^2_1 y_2 - x^2_2 y_1 + (x^2_2 - x^2_1) y_0)/(x_2 x^2_1 - x^2_2 x_1)</font>
<a name="line308">308: </a><font color="#B22222">           c = y_0</font>
<a name="line309">309: </a><font color="#B22222">           x_min = -b/2a</font>

<a name="line311">311: </a><font color="#B22222">           If we let x_{0,1,2} = 0, 0.5, 1.0</font>
<a name="line312">312: </a><font color="#B22222">           a = 2 y_2 - 4 y_1 + 2 y_0</font>
<a name="line313">313: </a><font color="#B22222">           b =  -y_2 + 4 y_1 - 3 y_0</font>
<a name="line314">314: </a><font color="#B22222">           c =   y_0</font>
<a name="line315">315: </a><font color="#B22222">      */</font>
<a name="line316">316: </a>      const <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> a = (alphas[1]*norms[2] - alphas[2]*norms[1] + (alphas[2] - alphas[1])*norms[0])/
<a name="line317">317: </a>        (PetscSqr(alphas[2])*alphas[1] - alphas[2]*PetscSqr(alphas[1]));
<a name="line318">318: </a>      const <A href="../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> b = (PetscSqr(alphas[1])*norms[2] - PetscSqr(alphas[2])*norms[1] + (PetscSqr(alphas[2]) - PetscSqr(alphas[1]))*norms[0])/
<a name="line319">319: </a>        (alphas[2]*PetscSqr(alphas[1]) - PetscSqr(alphas[2])*alphas[1]);
<a name="line320">320: </a>      <font color="#B22222">/* Check for positive a (concave up) */</font>
<a name="line321">321: </a>      <font color="#4169E1">if</font> (a &gt;= 0.0) {
<a name="line322">322: </a>        alpha = -b/(2.0*a);
<a name="line323">323: </a>        alpha = PetscMin(alpha, alphas[2]);
<a name="line324">324: </a>        alpha = PetscMax(alpha, alphas[0]);
<a name="line325">325: </a>      } <font color="#4169E1">else</font> {
<a name="line326">326: </a>        alpha = 1.0;
<a name="line327">327: </a>      }
<a name="line328">328: </a>      <A href="../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(snes-&gt;hdr.comm, <font color="#666666">"norms[0] = %g, norms[1] = %g, norms[2] = %g\n"</font>, norms[0], norms[1], norms[2]);
<a name="line329">329: </a>      <A href="../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(snes-&gt;hdr.comm, <font color="#666666">"Choose alpha = %g\n"</font>, alpha);
<a name="line330">330: </a>      <A href="../../../../docs/manualpages/Vec/VecAXPBY.html#VecAXPBY">VecAXPBY</A>(X, alpha, 1 - alpha, Y);
<a name="line331">331: </a>      <A href="../../../../docs/manualpages/SNES/SNESComputeFunction.html#SNESComputeFunction">SNESComputeFunction</A>(snes, X, F);
<a name="line332">332: </a>      <A href="../../../../docs/manualpages/Vec/VecNorm.html#VecNorm">VecNorm</A>(F, <A href="../../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A>, &amp;fnorm);
<a name="line333">333: </a><font color="#A020F0">#endif</font>
<a name="line334">334: </a>    }
<a name="line335">335: </a>    <font color="#4169E1">if</font> (!lsSuccess) {
<a name="line336">336: </a>      <font color="#4169E1">if</font> (++snes-&gt;numFailures &gt;= snes-&gt;maxFailures) {
<a name="line337">337: </a>        snes-&gt;reason = <A href="../../../../docs/manualpages/SNES/SNES_DIVERGED_LS_FAILURE.html#SNES_DIVERGED_LS_FAILURE">SNES_DIVERGED_LS_FAILURE</A>;
<a name="line338">338: </a>        <font color="#4169E1">break</font>;
<a name="line339">339: </a>      }
<a name="line340">340: </a>    }
<a name="line341">341: </a>    <font color="#4169E1">if</font> (snes-&gt;nfuncs &gt;= snes-&gt;max_funcs) {
<a name="line342">342: </a>      snes-&gt;reason = <A href="../../../../docs/manualpages/SNES/SNES_DIVERGED_FUNCTION_COUNT.html#SNES_DIVERGED_FUNCTION_COUNT">SNES_DIVERGED_FUNCTION_COUNT</A>;
<a name="line343">343: </a>      <font color="#4169E1">break</font>;
<a name="line344">344: </a>    }
<a name="line345">345: </a>    <font color="#4169E1">if</font> (snes-&gt;domainerror) {
<a name="line346">346: </a>      snes-&gt;reason = SNES_DIVERGED_FUNCTION_DOMAIN;
<a name="line347">347: </a>      <font color="#4169E1">return</font>(0);
<a name="line348">348: </a>    }
<a name="line349">349: </a>    <font color="#B22222">/* Monitor convergence */</font>
<a name="line350">350: </a>    PetscObjectTakeAccess(snes);
<a name="line351">351: </a>    snes-&gt;iter = i+1;
<a name="line352">352: </a>    snes-&gt;norm = fnorm;
<a name="line353">353: </a>    PetscObjectGrantAccess(snes);
<a name="line354">354: </a>    SNESLogConvHistory(snes,snes-&gt;norm,0);
<a name="line355">355: </a>    SNESMonitor(snes,snes-&gt;iter,snes-&gt;norm);
<a name="line356">356: </a>    <font color="#B22222">/* Test for convergence */</font>
<a name="line357">357: </a>    (*snes-&gt;ops-&gt;converged)(snes,snes-&gt;iter,0.0,0.0,fnorm,&amp;snes-&gt;reason,snes-&gt;cnvP);
<a name="line358">358: </a>    <font color="#4169E1">if</font> (snes-&gt;reason) <font color="#4169E1">break</font>;
<a name="line359">359: </a>  }
<a name="line360">360: </a>  <font color="#4169E1">if</font> (i == maxits) {
<a name="line361">361: </a>    PetscInfo1(snes, <font color="#666666">"Maximum number of iterations has been reached: %D\n"</font>, maxits);
<a name="line362">362: </a>    <font color="#4169E1">if</font> (!snes-&gt;reason) snes-&gt;reason = <A href="../../../../docs/manualpages/SNES/SNES_DIVERGED_MAX_IT.html#SNES_DIVERGED_MAX_IT">SNES_DIVERGED_MAX_IT</A>;
<a name="line363">363: </a>  }
<a name="line364">364: </a>  <font color="#4169E1">return</font>(0);
<a name="line365">365: </a>}

<a name="line371">371: </a><strong><font color="#4169E1"><a name="SNESLineSearchSetPreCheck_Picard"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  SNESLineSearchSetPreCheck_Picard(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes, FCN1 func, void *checkctx)</font></strong>
<a name="line372">372: </a>{
<a name="line374">374: </a>  ((SNES_Picard *)(snes-&gt;data))-&gt;precheckstep = func;
<a name="line375">375: </a>  ((SNES_Picard *)(snes-&gt;data))-&gt;precheck     = checkctx;
<a name="line376">376: </a>  <font color="#4169E1">return</font>(0);
<a name="line377">377: </a>}

<a name="line384">384: </a><strong><font color="#4169E1"><a name="SNESLineSearchSet_Picard"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  SNESLineSearchSet_Picard(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes, FCN2 func, void *lsctx)</font></strong>
<a name="line385">385: </a>{
<a name="line387">387: </a>  ((SNES_Picard *)(snes-&gt;data))-&gt;LineSearch = func;
<a name="line388">388: </a>  ((SNES_Picard *)(snes-&gt;data))-&gt;lsP        = lsctx;
<a name="line389">389: </a>  <font color="#4169E1">return</font>(0);
<a name="line390">390: </a>}

<a name="line397">397: </a><strong><font color="#4169E1"><a name="SNESLineSearchSetPostCheck_Picard"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  SNESLineSearchSetPostCheck_Picard(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes, FCN3 func, void *checkctx)</font></strong>
<a name="line398">398: </a>{
<a name="line400">400: </a>  ((SNES_Picard *)(snes-&gt;data))-&gt;postcheckstep = func;
<a name="line401">401: </a>  ((SNES_Picard *)(snes-&gt;data))-&gt;postcheck     = checkctx;
<a name="line402">402: </a>  <font color="#4169E1">return</font>(0);
<a name="line403">403: </a>}

<a name="line406">406: </a><font color="#B22222">/*MC</font>
<a name="line407">407: </a><font color="#B22222">  <A href="../../../../docs/manualpages/SNES/SNESPICARD.html#SNESPICARD">SNESPICARD</A> - Picard nonlinear solver that uses successive substitutions</font>

<a name="line409">409: </a><font color="#B22222">  Level: beginner</font>

<a name="line411">411: </a><font color="#B22222">.seealso:  <A href="../../../../docs/manualpages/SNES/SNESCreate.html#SNESCreate">SNESCreate</A>(), <A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A>, <A href="../../../../docs/manualpages/SNES/SNESSetType.html#SNESSetType">SNESSetType</A>(), <A href="../../../../docs/manualpages/SNES/SNESLS.html#SNESLS">SNESLS</A>, <A href="../../../../docs/manualpages/SNES/SNESTR.html#SNESTR">SNESTR</A></font>
<a name="line412">412: </a><font color="#B22222">M*/</font>
<a name="line416">416: </a><strong><font color="#4169E1"><a name="SNESCreate_Picard"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  SNESCreate_Picard(<A href="../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> snes)</font></strong>
<a name="line417">417: </a>{
<a name="line418">418: </a>  SNES_Picard   *neP;

<a name="line422">422: </a>  snes-&gt;ops-&gt;destroy            = SNESDestroy_Picard;
<a name="line423">423: </a>  snes-&gt;ops-&gt;setup                = SNESSetUp_Picard;
<a name="line424">424: </a>  snes-&gt;ops-&gt;setfromoptions = SNESSetFromOptions_Picard;
<a name="line425">425: </a>  snes-&gt;ops-&gt;view           = SNESView_Picard;
<a name="line426">426: </a>  snes-&gt;ops-&gt;solve                = SNESSolve_Picard;

<a name="line428">428: </a>  PetscNewLog(snes, SNES_Picard, &amp;neP);
<a name="line429">429: </a>  snes-&gt;data = (void*) neP;
<a name="line430">430: </a>  neP-&gt;type  = 0;
<a name="line431">431: </a>  neP-&gt;alpha                 = 1.e-4;
<a name="line432">432: </a>  neP-&gt;maxstep                 = 1.e8;
<a name="line433">433: </a>  neP-&gt;steptol       = 1.e-12;
<a name="line434">434: </a>  neP-&gt;LineSearch    = <A href="../../../../docs/manualpages/SNES/SNESLineSearchNo.html#SNESLineSearchNo">SNESLineSearchNo</A>;
<a name="line435">435: </a>  neP-&gt;lsP           = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
<a name="line436">436: </a>  neP-&gt;postcheckstep = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
<a name="line437">437: </a>  neP-&gt;postcheck     = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
<a name="line438">438: </a>  neP-&gt;precheckstep  = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
<a name="line439">439: </a>  neP-&gt;precheck      = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;

<a name="line441">441: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)snes,<font color="#666666">"SNESLineSearchSet_C"</font>,
<a name="line442">442: </a>                                           <font color="#666666">"SNESLineSearchSet_Picard"</font>,
<a name="line443">443: </a>                                           SNESLineSearchSet_Picard);
<a name="line444">444: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)snes,<font color="#666666">"SNESLineSearchSetPostCheck_C"</font>,
<a name="line445">445: </a>                                           <font color="#666666">"SNESLineSearchSetPostCheck_Picard"</font>,
<a name="line446">446: </a>                                           SNESLineSearchSetPostCheck_Picard);
<a name="line447">447: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)snes,<font color="#666666">"SNESLineSearchSetPreCheck_C"</font>,
<a name="line448">448: </a>                                           <font color="#666666">"SNESLineSearchSetPreCheck_Picard"</font>,
<a name="line449">449: </a>                                           SNESLineSearchSetPreCheck_Picard);
<a name="line450">450: </a>  <font color="#4169E1">return</font>(0);
<a name="line451">451: </a>}
</pre>
</body>

</html>
